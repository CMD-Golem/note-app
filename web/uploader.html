<input type="file" id="imageInput" accept="image/*">

<script>
async function uploadBlob(store, path) {
	var input = document.getElementById('imageInput');
	var file = input.files[0];
	if (!file) {
		alert('Please select an image first.');
		return;
	}

	var reader = new FileReader();
	reader.onload = async function(e) {
		var image_data = Uint8Array.from(atob(e.target.result), c => c.charCodeAt(0)); // ArrayBuffer
		// var image_data = await fetch(e.target.result).then(r => r.blob()); // Blob

		var response = await fetch("/.netlify/functions/blob_handler", {
			method: "PUT",
			body: JSON.stringify({
				store: store,
				path: path,
				data: image_data
			})
		});
		var result = await response.json();
		console.log(result);
	};
	reader.readAsDataURL(file);
}

async function deleteBlob(store, path) {
	var response = await fetch("/.netlify/functions/blob_handler", {
		method: "DELETE",
		body: JSON.stringify({
			store: store,
			path: path
		})
	});
}

async function getBlob(store, path, type) {
	var response = await fetch("/.netlify/functions/blob_handler", {
		method: "POST",
		body: JSON.stringify({
			store: store,
			path: path,
			type: type
		})
	});

	// doesnt work (also with blob)
	var image_data = await response.arrayBuffer();
    var blob = new Blob( [ image_data ], { type: "image/jpeg" } );
    var urlCreator = window.URL || window.webkitURL;
    var imageUrl = urlCreator.createObjectURL( blob );
}
</script>